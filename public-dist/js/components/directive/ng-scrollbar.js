define(["angular","./module"],function(e,t){t.directive("ngScrollbar",[function(){return{restrict:"AE",transclude:!0,scope:{scrollbarConfig:"=scrollbarConfig",scrollbarX:"@",scrollbarY:"@"},template:'<div style="position:relative;width:100%;height:100%;">   <div class="ngscroll-content-container" style="display:inline-block;margin-top:0;margin-left:0" ng-transclude></div>   <ng-scrollbar-x ng-if="scrollbarX || scrollbarX === undefined"></ng-scrollbar-x>   <ng-scrollbar-y ng-if="scrollbarY || scrollbarY === undefined"></ng-scrollbar-y></div>',controller:function(){var t={dragSpeed:1,autoResize:!1,show:!1,scrollbar:{width:6,hoverWidth:8,color:"rgba(0,0,0,.6)"},scrollbarContainer:{width:12,color:"rgba(0,0,0,.1)"}},n,r,i,s,o;this.init=function(u,a){n=u,i=e.copy(e.extend(t,a||{})),r=e.element(u[0].querySelector(".ngscroll-content-container")),s=(i.scrollbarContainer.width-i.scrollbar.width)/2,o=(i.scrollbarContainer.width-i.scrollbar.hoverWidth)/2},e.extend(this,{winEl:e.element(window),getContainerElement:function(){return n},getContentElement:function(){return r},getConfig:function(){return i},getScrollbarMargin:function(){return s},getScrollbarHoverMargin:function(){return o}})},compile:function(e){return e.css("overflow","hidden"),function(e,t,n,r){r.init(t,e.scrollbarConfig)}}}}]),t.directive("ngScrollbarY",["$timeout",function(t){return{restrict:"AE",require:"^ngScrollbar",replace:!0,template:'<div class="ngscrollbar-container-y" ng-style="styles.scrollbarContainer"><div class="ngscrollbar-y" ng-style="styles.scrollbar"></div></div>',compile:function(){return function(n,r,i,s){var o=s.getConfig(),u=e.element(document),a=s.getContainerElement(),f=s.getContentElement(),l=e.element(r[0].querySelector(".ngscrollbar-y")),c=s.getScrollbarMargin(),h=s.getScrollbarHoverMargin();n.styles={scrollbarContainer:{position:"absolute",width:o.scrollbarContainer.width+"px",height:"100%",top:0,right:0,transition:"background .3s ease-in-out","border-radius":o.scrollbarContainer.width/2+"px"},scrollbar:{position:"absolute",width:o.scrollbar.width+"px",right:c+"px",cursor:"default",opacity:0,transition:"opacity .3s ease-in-out, border-radius .1s linear, width .1s linear, right .1s linear",background:o.scrollbar.color,"border-radius":o.scrollbar.width/2+"px"}};var p=function(){return f[0].offsetHeight},d=function(){return a[0].offsetHeight},v=function(){var e=Math.pow(d(),2)/p()-c*2;return e},m=function(){return p()>d()},g=function(){l.css("opacity",0)},y=function(){l.css("opacity",1)},b=function(){var e=parseInt(f.css("margin-top"),10);f.css("margin-top","0px"),m()?(r.css("display","block"),l.css("height",v()+"px"),w(e),o.show&&y()):r.css("display","none")},w=function(e){e=Math.min(0,Math.max(e,d()-p())),f.css("margin-top",e+"px"),l.css("top",-e/p()*d()+c+"px")},E=function(e){var t=parseInt(f.css("margin-top"),10)+e;w(t)};a.on("mousewheel",function(e){if(!m())return;e.preventDefault(),e.originalEvent!==undefined&&(e=e.originalEvent),E(e.wheelDeltaY||e.wheelDelta)}),window.navigator.userAgent.toLowerCase().indexOf("firefox")>=0&&a.on("wheel",function(e){if(!m())return;e.preventDefault(),e.originalEvent!==undefined&&(e=e.originalEvent),E(-e.deltaY*40)}),r.on("mouseenter",function(){r.css("background",o.scrollbarContainer.color),l.css("width",o.scrollbar.hoverWidth+"px"),l.css("right",h+"px"),l.css("border-radius",o.scrollbar.hoverWidth/2+"px")}),r.on("mouseleave",function(){r.css("background","none"),l.css("width",o.scrollbar.width+"px"),l.css("right",c+"px"),l.css("border-radius",o.scrollbar.width/2+"px")});var S=!1,x,T=!1;o.show||(a.on("mouseenter",function(){T=!0,y()}),a.on("mouseleave",function(){T=!1;if(S)return;g()})),l.on("mousedown",function(e){e.preventDefault(),x=e.screenY,S=!0,u.one("mouseup",function(){S=!1,!o.show&&!T&&g()})}),u.on("mousemove",function(e){S&&(e.preventDefault(),E(-(e.screenY-x)*o.dragSpeed*p()/d()),x=e.screenY)}),t(function(){b();if(!document.createStyleSheet){var e=new MutationObserver(function(e){e.length&&b()});e.observe(f[0],{childList:!0,subtree:!0})}else f.on("DOMNodeInserted",b),f.on("DOMNodeRemoved",b)},5),o.autoResize&&function(){var e;s.winEl.on("resize",function(t){e&&clearTimeout(e),e=setTimeout(function(){e=null,b()},50)})}()}}}}]),t.directive("ngScrollbarX",["$timeout",function(t){return{restrict:"AE",replace:!0,require:"^ngScrollbar",template:'<div class="ngscrollbar-container-x" ng-style="styles.scrollbarContainer"><div class="ngscrollbar-x" ng-style="styles.scrollbar"></div></div>',compile:function(){return function(n,r,i,s){var o=s.getConfig(),u=e.element(document),a=s.getContainerElement(),f=a[0],l=s.getContentElement(),c=e.element(r[0].querySelector(".ngscrollbar-x")),h=s.getScrollbarMargin(),p=s.getScrollbarHoverMargin();n.styles={scrollbarContainer:{position:"absolute",width:"100%",transition:"background .3s ease-in-out","border-radius":o.scrollbarContainer.width/2+"px"},scrollbar:{position:"absolute",cursor:"default",opacity:0,transition:"opacity .3s ease-in-out, border-radius .1s linear, width .1s linear, right .1s linear",background:o.scrollbar.color,"border-radius":o.scrollbar.width/2+"px"}},r.css("height",o.scrollbarContainer.width+"px"),r.css("bottom",0),r.css("left",0),c.css("top",h+"px"),c.css("height",o.scrollbar.width+"px");var d=function(){return l[0].offsetWidth},v=function(){return f.offsetWidth},m=function(){return Math.pow(v(),2)/d()-h*2},g=function(){c.css("opacity",1)},y=function(){c.css("opacity",0)},b=function(){return d()>v()},w=function(){var e=parseInt(l.css("margin-left"),10);l.css("margin-left","0px"),b()?(r.css("display","block"),c.css("width",m()+"px"),E(e),o.show&&g()):r.css("display","none")},E=function(e){e=Math.min(0,Math.max(e,v()-d())),l.css("margin-left",e+"px"),c.css("left",-e/d()*v()+h+"px")},S=function(e){var t=parseInt(l.css("margin-left"),10)+e;E(t)};r.on("mouseenter",function(){r.css("background",o.scrollbarContainer.color),c.css("height",o.scrollbar.hoverWidth+"px"),c.css("top",p+"px"),c.css("border-radius",o.scrollbar.hoverWidth/2+"px")}),r.on("mouseleave",function(){r.css("background","none"),c.css("height",o.scrollbar.width+"px"),c.css("top",h+"px"),c.css("border-radius",o.scrollbar.width/2+"px")});var x=!1,T,N=!1;o.show||(a.on("mouseenter",function(){N=!0,g()}),a.on("mouseleave",function(){N=!1;if(x)return;y()})),c.on("mousedown",function(e){e.preventDefault(),x=!0,T=e.screenX,u.one("mouseup",function(){x=!1,!o.show&&!N&&y()})}),u.on("mousemove",function(e){x&&(e.preventDefault(),S(-(e.screenX-T)*o.dragSpeed*d()/v()),T=e.screenX)}),t(function(){w();if(!document.createStyleSheet){var e=new MutationObserver(function(e){e.length&&w()});e.observe(l[0],{childList:!0,subtree:!0})}else l.on("DOMNodeInserted",w),l.on("DOMNodeRemoved",w)},5),o.autoResize&&function(){var e;s.winEl.on("resize",function(t){e&&clearTimeout(e),e=setTimeout(function(){e=null,w()},50)})}()}}}}])});