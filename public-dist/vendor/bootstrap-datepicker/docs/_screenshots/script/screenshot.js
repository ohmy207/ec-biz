var sys=require("system"),page=new WebPage;page.viewportSize={width:800,height:600},page.open(sys.args[1],function(e){e!=="success"&&(console.log("Bad status: %s",e),phantom.exit(1)),window.setTimeout(function(){var e=page.evaluate(function(){var e,t,n,r,i=10,s,o;window.setup&&window.setup(),o=$("body").data("show"),o=o?$(o):$("*"),o.filter(function(){return"datepicker"in $(this).data()}).datepicker("show"),s=$($("body").data("capture")),n=s.map(function(){return $(this).offset().top}).toArray(),e=s.map(function(){return $(this).offset().left}).toArray(),r=s.map(function(){return $(this).offset().top+$(this).outerHeight()}).toArray(),t=s.map(function(){return $(this).offset().left+$(this).outerWidth()}).toArray();var u={top:Math.min.apply(Math,n),left:Math.min.apply(Math,e)};return u.width=Math.max.apply(Math,t)-u.left,u.height=Math.max.apply(Math,r)-u.top,{top:Math.max(u.top-i,0),left:Math.max(u.left-i,0),width:u.width+2*i,height:u.height+2*i}});page.clipRect=e,page.render(sys.args[2]),phantom.exit()},1)});